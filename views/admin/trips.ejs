<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | Trip Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('../partials/navbar') %>

<div class="container py-5">
  <h2 class="mb-4 text-warning text-center">Trip Planner</h2>

  <% if (trips.length === 0) { %>
    <div class="alert alert-info text-center">
      No trips available.
    </div>
  <% } else { %>
    <div class="table-responsive">
      <table class="table table-hover align-middle text-white" style="background: rgba(0,0,0,0.6); border-radius:10px;">
        <thead>
          <tr class="text-warning">
            <th>#</th>
            <th>Destination</th>
            <th>Created By</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Notes</th>
            <th>Booking Details</th>
          </tr>
        </thead>
        <tbody>
          <% trips.forEach((trip, index) => { %>
            <tr>
              <th scope="row"><%= index + 1 %></th>
              <td><%= trip.destination ? trip.destination.name : 'Unknown' %></td>
              <td><%= trip.user ? trip.user.name : 'Unknown' %></td>
              <td><%= new Date(trip.startDate).toLocaleDateString() %></td>
              <td><%= new Date(trip.endDate).toLocaleDateString() %></td>
              <td><%= trip.notes || '-' %></td>
              <td>
                <% if(trip.bookings.length > 0) { %>
                  <% trip.bookings.forEach(booking => { %>
                    <div class="mb-2 p-2" style="background: rgba(255,255,0,0.2); border-radius:5px;">
                      <a href="/guide/<%= booking.guide._id %>" class="">
          View Guide Profile
        </a><br>
                      Booking Start: <%= new Date(booking.startDate).toLocaleDateString() %><br>
                      Booking End: <%= new Date(booking.endDate).toLocaleDateString() %><br>
                      Status: <%= booking.status %>
                    </div>
                  <% }) %>
                <% } else { %>
                  No accepted bookings
                <% } %>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  <% } %>
</div>
 <%- include('../partials/footer') %>
</body>
</html>